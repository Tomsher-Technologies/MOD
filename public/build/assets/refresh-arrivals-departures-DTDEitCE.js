document.addEventListener("DOMContentLoaded",function(){const s=document.getElementById("fullDiv")!==null,f=document.getElementById("fullDiv1")!==null;if(!s&&!f)return;function g(){console.log("refreshing");const l=new URL(window.location.href).toString();fetch(l,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(e=>e.json()).then(e=>{if(e.success&&e.data){const t=s?document.getElementById("arrivals-table-container"):document.getElementById("departures-table-container");if(t){const r=document.createElement("div");r.innerHTML=e.data;const c=r.querySelector("table"),o=r.querySelector(".mt-3.flex.items-center.flex-wrap.gap-4");if(r.querySelector('[id$="-table-column-visibility-modal"]'),c){c.classList.remove("hidden");const i=t.querySelector("table");if(i?i.replaceWith(c):(t.innerHTML="",t.appendChild(c)),o){const a=t.nextElementSibling;a&&a.classList.contains("mt-3")?a.replaceWith(o):t.parentNode.insertBefore(o,t.nextSibling)}d(),setTimeout(()=>{typeof $<"u"&&$.fn.select2&&$(".select2").select2({placeholder:"Select an option",allowClear:!0}),u()},100)}}console.log("Data refreshed at: "+new Date().toLocaleTimeString())}}).catch(e=>{console.error("Error refreshing data:",e)})}function u(){document.querySelectorAll(".edit-arrival-btn").forEach(e=>{e.addEventListener("click",()=>{const t=JSON.parse(e.getAttribute("data-arrival"));window.dispatchEvent(new CustomEvent("open-edit-arrival",{detail:t}))})}),document.querySelectorAll(".edit-departure-btn").forEach(e=>{e.addEventListener("click",()=>{const t=JSON.parse(e.getAttribute("data-departure"));window.dispatchEvent(new CustomEvent("open-edit-departure",{detail:t}))})});const n=document.getElementById("fullscreenToggleBtn");n&&n.addEventListener("click",m);const l=document.getElementById("fullscreenToggleBtn1");l&&l.addEventListener("click",m)}function d(){document.querySelectorAll('[id$="-column-toggles"]').forEach(n=>{const l=n.id.replace("-column-toggles",""),e=l+"_column_visibility",t=JSON.parse(localStorage.getItem(e));t&&Object.keys(t).forEach(r=>{const c=t[r];document.querySelectorAll(`#${l} th[data-column-key='${r}'], #${l} td[data-column-key='${r}']`).forEach(i=>{i.style.display=c?"":"none"});const o=n.querySelector(`.column-toggle-checkbox[value="${r}"]`);o&&(o.checked=c)})})}function m(){const n=document.getElementById("fullDiv")||document.getElementById("fullDiv1"),l=document.querySelectorAll(".full-screen-logo");document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),l.forEach(e=>e.classList.add("hidden"))):(n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen(),l.forEach(e=>e.classList.remove("hidden")))}u(),d(),setInterval(g,6e4),console.log("Auto-refresh initialized for "+(s?"arrivals":"departures")+" page")});
