document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("fullDiv")!==null,f=document.getElementById("fullDiv1")!==null;if(!d&&!f)return;function g(){console.log("refreshing");const l=d?window.location.origin+"/mod-admin/arrivals":window.location.origin+"/mod-admin/departures";fetch(l,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(t=>t.json()).then(t=>{if(t.success&&t.data){const e=d?document.getElementById("arrivals-table-container"):document.getElementById("departures-table-container");if(e){const n=document.createElement("div");n.innerHTML=t.data;const o=n.querySelector("table"),i=n.querySelector(".mt-3.flex.items-center.flex-wrap.gap-4"),r=n.querySelector('[id$="-table-column-visibility-modal"]');if(o){o.classList.remove("hidden");const s=e.querySelector("table");if(s?s.replaceWith(o):(e.innerHTML="",e.appendChild(o)),i){const c=e.nextElementSibling;c&&c.classList.contains("mt-3")?c.replaceWith(i):e.parentNode.insertBefore(i,e.nextSibling)}if(r){const c=document.querySelector('[id$="-table-column-visibility-modal"]');c?c.replaceWith(r):document.body.appendChild(r)}setTimeout(()=>{typeof $<"u"&&$.fn.select2&&$(".select2").select2({placeholder:"Select an option",allowClear:!0}),a(),u()},100)}}console.log("Data refreshed at: "+new Date().toLocaleTimeString())}}).catch(t=>{console.error("Error refreshing data:",t)})}function a(){document.querySelectorAll(".edit-arrival-btn").forEach(e=>{e.addEventListener("click",()=>{const n=JSON.parse(e.getAttribute("data-arrival"));window.dispatchEvent(new CustomEvent("open-edit-arrival",{detail:n}))})}),document.querySelectorAll(".edit-departure-btn").forEach(e=>{e.addEventListener("click",()=>{const n=JSON.parse(e.getAttribute("data-departure"));window.dispatchEvent(new CustomEvent("open-edit-departure",{detail:n}))})});const l=document.getElementById("fullscreenToggleBtn");l&&l.addEventListener("click",m);const t=document.getElementById("fullscreenToggleBtn1");t&&t.addEventListener("click",m)}function u(){document.querySelectorAll(".column-toggle-checkbox").forEach(l=>{l.addEventListener("change",function(){const t=this.value,e=this.closest('[id$="-table-column-toggles"]').id.replace("-column-toggles",""),n=document.getElementById(e);if(n){const o=Array.from(n.querySelectorAll("th[data-column-key]")).findIndex(i=>i.getAttribute("data-column-key")===t);if(o>=0){const i=n.querySelectorAll("th")[o];i&&i.classList.toggle("hidden",!this.checked),n.querySelectorAll("tbody tr").forEach(r=>{const s=r.querySelectorAll("td")[o];s&&s.classList.toggle("hidden",!this.checked)})}}})})}function m(){const l=document.getElementById("fullDiv")||document.getElementById("fullDiv1"),t=document.querySelectorAll(".full-screen-logo");document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),t.forEach(e=>e.classList.add("hidden"))):(l.requestFullscreen?l.requestFullscreen():l.webkitRequestFullscreen?l.webkitRequestFullscreen():l.msRequestFullscreen&&l.msRequestFullscreen(),t.forEach(e=>e.classList.remove("hidden")))}a(),u(),setInterval(g,3e5),console.log("Auto-refresh initialized for "+(d?"arrivals":"departures")+" page")});
