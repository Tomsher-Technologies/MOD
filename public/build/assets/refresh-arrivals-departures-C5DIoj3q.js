document.addEventListener("DOMContentLoaded",function(){const r=document.getElementById("fullDiv")!==null,g=document.getElementById("fullDiv1")!==null;if(!r&&!g)return;function h(){console.log("refreshing");const l=new URL(window.location.href).toString();fetch(l,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(e=>e.json()).then(e=>{if(e.success&&e.data){const n=r?document.getElementById("arrivals-table-container"):document.getElementById("departures-table-container");if(n){const c=document.createElement("div");c.innerHTML=e.data;const o=c.querySelector("table"),s=c.querySelector(".mt-3.flex.items-center.flex-wrap.gap-4"),a=c.querySelector('[id$="-table-column-visibility-modal"]');if(o){o.classList.remove("hidden");const f=n.querySelector("table");if(f?f.replaceWith(o):(n.innerHTML="",n.appendChild(o)),s){const i=n.nextElementSibling;i&&i.classList.contains("mt-3")?i.replaceWith(s):n.parentNode.insertBefore(s,n.nextSibling)}if(a){const i=document.querySelector('[id$="-table-column-visibility-modal"]');i?i.replaceWith(a):document.body.appendChild(a)}setTimeout(()=>{typeof $<"u"&&$.fn.select2&&$(".select2").select2({placeholder:"Select an option",allowClear:!0}),d(),u()},100)}}console.log("Data refreshed at: "+new Date().toLocaleTimeString())}}).catch(e=>{console.error("Error refreshing data:",e)})}function d(){document.querySelectorAll(".edit-arrival-btn").forEach(e=>{e.addEventListener("click",()=>{const n=JSON.parse(e.getAttribute("data-arrival"));window.dispatchEvent(new CustomEvent("open-edit-arrival",{detail:n}))})}),document.querySelectorAll(".edit-departure-btn").forEach(e=>{e.addEventListener("click",()=>{const n=JSON.parse(e.getAttribute("data-departure"));window.dispatchEvent(new CustomEvent("open-edit-departure",{detail:n}))})});const t=document.getElementById("fullscreenToggleBtn");t&&t.addEventListener("click",m);const l=document.getElementById("fullscreenToggleBtn1");l&&l.addEventListener("click",m)}function u(){document.querySelectorAll(".column-toggle-checkbox").forEach(t=>{t.addEventListener("change",function(){const l=this.value,e=this.closest('[id$="-table-column-toggles"]').id.replace("-column-toggles","");if(document.getElementById(e)){const c=this.checked;document.querySelectorAll(`#${e} th[data-column-key='${l}'], #${e} td[data-column-key='${l}']`).forEach(o=>{o.style.display=c?"":"none"})}})})}function m(){const t=document.getElementById("fullDiv")||document.getElementById("fullDiv1"),l=document.querySelectorAll(".full-screen-logo");document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),l.forEach(e=>e.classList.add("hidden"))):(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),l.forEach(e=>e.classList.remove("hidden")))}d(),u(),setInterval(h,5e3),console.log("Auto-refresh initialized for "+(r?"arrivals":"departures")+" page")});
